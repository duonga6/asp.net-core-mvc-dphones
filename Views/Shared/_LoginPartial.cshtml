@using Microsoft.AspNetCore.Identity
@using App.Models

@inject SignInManager<AppUser> SignInManager
@inject UserManager<AppUser> UserManager

<ul class="navbar-nav ms-2 d-flex align-items-center">
    @if (SignInManager.IsSignedIn(User))
    {
        var user = await UserManager.GetUserAsync(User);
        var displayName = (user != null && !string.IsNullOrEmpty(user.FullName)) ? $"{user.FullName}" : $"{user?.Email}";
        var userAvatar = "/files/UserAvatar/" + (string.IsNullOrEmpty(user?.UserAvatar) ? "no-image.png" : user.UserAvatar);
        
        <li class="nav-item">
            <div class="collapse navbar-collapse" id="navbarNavDarkDropdown">
                <ul class="navbar-nav">
                    <li class="nav-item dropdown">
                        <a class="nav-link text-white dropdown-toggle d-flex align-items-center" href="#" id="navbarDarkDropdownMenuLink" role="button"
                            data-bs-toggle="dropdown" aria-expanded="false">
                            
                        <div class="header-user-avatar d-flex justify-content-center align-items-center">
                            <img src="@userAvatar" alt="">
                        </div>
                            @displayName
                        </a>
                        <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDarkDropdownMenuLink">
                            <li><a class="dropdown-item" asp-area="Identity" asp-action="Index" asp-controller="Manage">Tài
                                    khoản của tôi</a></li>
                            <li><partial name="_MenuAdmin"/></li>
                            <li>
                                <form method="post" class="form-inline" asp-action="LogOff" asp-controller="Account"
                                    asp-area="Identity">
                                    <button id="logout" type="submit"
                                        class="dropdown-item btn btn-link text-dark border-0">Đăng
                                        xuất</button>
                                </form>
                            </li>
                        </ul>
                    </li>
                </ul>
            </div>
        </li>
    }
    else
    {
        <li class="nav-item">
            <a class="nav-link text-white" id="login" asp-area="Identity" asp-action="Login" asp-controller="Account">
                <i class="fa-regular fa-user"></i>
                Đăng nhập
            </a>
        </li>
    }
</ul>
